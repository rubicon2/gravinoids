(()=>{"use strict";var t={28:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(81),o=n.n(i),s=n(645),r=n.n(s)()(o());r.push([t.id,":root {\r\n    box-sizing: border-box;\r\n}\r\n\r\n*, *:before, *:after {\r\n    box-sizing: inherit;\r\n}\r\n\r\nbody {\r\n    width: 100vw;\r\n    height: 100vh;\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: rgb(0, 10, 23);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n#renderCanvas {\r\n    width: inherit;\r\n    height: inherit;\r\n}",""]);const a=r},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,o,s){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&r[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),e.push(u))}},e}},81:t=>{t.exports=function(t){return t[1]}},89:(t,e,n)=>{n.r(e),n.d(e,{default:()=>g});var i=n(379),o=n.n(i),s=n(795),r=n.n(s),a=n(569),l=n.n(a),c=n(565),u=n.n(c),h=n(216),p=n.n(h),d=n(589),y=n.n(d),f=n(28),v={};v.styleTagTransform=y(),v.setAttributes=u(),v.insert=l().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=p(),o()(f.Z,v);const g=f.Z&&f.Z.locals?f.Z.locals:void 0},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},r=[],a=0;a<t.length;a++){var l=t[a],c=i.base?l[0]+i.base:l[0],u=s[c]||0,h="".concat(c," ").concat(u);s[c]=u+1;var p=n(h),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(d);else{var y=o(d,i);i.byIndex=a,e.splice(a,0,{identifier:h,updater:y,references:1})}r.push(h)}return r}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var s=i(t=t||[],o=o||{});return function(t){t=t||[];for(var r=0;r<s.length;r++){var a=n(s[r]);e[a].references--}for(var l=i(t,o),c=0;c<s.length;c++){var u=n(s[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}s=l}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nc=void 0,(()=>{const t=function(t,e,n){return Math.max(Math.min(n,e),t)},e=function(t,e){return t*=e=Math.pow(10,e),(t=Math.round(t))/e},i=function(t,e,n){return t+(e-t)*n},o=function(t,e,n){return(n-t)/(e-t)},s=function(t,e,n){let s=o(t,e,n);return s=(1+s%1)%1,i(t,e,s)},r=function(t,e,n){return Math.round(s(t,e,n))},a=function(t,e,n,s,r){const a=o(e,n,t);return i(s,r,a)},l=function(t,e){return{x:t,y:e}},c=l(0,0),u=l(1,1),h=l(0,-1),p=(l(0,1),l(-1,0),l(1,0),function(t,e){return l(t.x+e.x,t.y+e.y)}),d=function(t,e){return l(t.x*e,t.y*e)},y=function(t){let e=f(t);return l(t.x/e,t.y/e)},f=function(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))},v=function(t,e){let n=Math.cos(g(e)),i=Math.sin(g(e));return l(n*t.x+-i*t.y,i*t.x+n*t.y)},g=function(t){return t*Math.PI/180},w={};function m(t,e){w[t]&&w[t].forEach((t=>{t(e)}))}class _{constructor(t,e,n){this.renderOrder=t,this.name=e,this.isVisible=n}}class S{constructor(t,e,n=!0){this.transform=t,this.layer=e,this.isVisible=n}}class b{constructor(t,e,n,i){this.text=t,this.font=e,this.strokeStyle=n,this.fillStyle=i}}class x extends S{constructor(t,e,n,i=!0){super(t,n,i),this.renderTextInfo=e}draw(t,e){let n=this.transform,i=this.renderTextInfo.text,{strokeStyle:o,fillStyle:s,font:r}=this.renderTextInfo,a="empty string";a="function"==typeof i?i():i,t.save(),t.translate(n.v2_position.x,n.v2_position.y),t.rotate(g(n.n_rotation)),t.strokeStyle=null!=o?o:"white",t.fillStyle=null!=s?s:"white",t.font=null!=r?r:"24px Arial",t.fillText(`${a}`,0,0),t.restore()}}class I extends S{constructor(t,e,n,i=!0){super(t,n,i),this.mesh=e}draw(t,e){let n=this.transform,i=this.mesh;t.save(),t.translate(n.v2_position.x,n.v2_position.y),t.rotate(g(n.n_rotation));let o=i.scaled(n.v2_scale);function s(n){let i=n.vertexArray,o=i[0];t.fillStyle=n.color,t.strokeStyle=n.color,t.beginPath(),t.moveTo(o.x*e,o.y*e);for(let n=1;n<i.length;n++)o=i[n],t.lineTo(o.x*e,o.y*e);t.closePath(),n.isColorFill?t.fill():t.stroke()}for(let t of o.polygons)s(t);t.restore()}}class k{static list=[];t_parent=null;v2_localPosition=c;n_localRotation=0;v2_scale=u;freeze_rotation=!1;constructor(t,e,n,i){this.v2_localPosition=t,this.n_localRotation=e,this.v2_localScale=n,this.t_parent=i,k.list.push(this)}get v2_position(){return null!=this.t_parent?this.freeze_rotation?p(this.t_parent.v2_position,this.v2_localPosition):p(this.t_parent.v2_position,v(this.v2_localPosition,this.t_parent.n_rotation)):this.v2_localPosition}get n_rotation(){return null==this.t_parent||this.freeze_rotation?this.n_localRotation:this.t_parent.n_rotation+this.n_localRotation}get forward(){return v(h,this.n_rotation)}}let T=null,A=null,M=c,C=window.devicePixelRatio,E=[],K={background:new _(0,"background",!0),game:new _(1,"game",!0),ui:new _(2,"ui",!0),debug:new _(3,"debug",!0)};const P=function(t){E.includes(t)||E.push(t),m("onAddToRenderList",t),m("onRenderListChange",E)};class V{static#t=new Map;static#e=new Map;static addBindingGroup(t,e,n){this.#e.has(t)?console.warn(`Attempted to overwrite binding group ${t}`):(this.#e.set(t,{isActive:e,inputSequences:n}),n.forEach((e=>{e.getAllInputKeys().forEach((e=>{this.#t.has(e)?console.warn(`Attempted to overwrite ${e}`):this.#t.set(e,t)}))})))}static createBoundInputKey(t,e){return`${t} ${e}`}static#n(t){let e=this.#t.get(this.createBoundInputKey(t.type,t.code));return this.#e.get(e)}static handleKeyDown(t){if(this.#t.has(this.createBoundInputKey(t.type,t.code)))for(let e of this.#n(t).inputSequences)e.handleInput(t)}static handleKeyUp(t){if(this.#t.has(this.createBoundInputKey(t.type,t.code)))for(let e of this.#n(t).inputSequences)e.handleInput(t)}}class B{#i=null;#o=0;#s=new Set;#r=null;#a=0;#l=null;#c=null;constructor(t,e=null){this.inputs=t,this.onInputBreak=e}getAllInputKeys(){let t=[];return this.inputs.forEach((e=>{e.codeSet.forEach((n=>{"hold"!=e.type?t.push(V.createBoundInputKey(e.type,n)):(t.push(V.createBoundInputKey("keydown",n)),t.push(V.createBoundInputKey("keyup",n)))}))})),t}handleInput(t){let e=t.code,n=t.type;if(this.#i=this.inputs[this.#o],this.#i.type===n)this.#i.codeSet.has(e)?this.#u(e):this.inputs[0].type===n&&this.inputs[0].codeSet.has(e)&&(this.#o=0,this.#s.clear(),this.#u(e));else if("hold"===this.#i.type)switch(n){case"keydown":this.#i.codeSet.has(e)&&this.#u(e);break;case"keyup":this.#s.has(e)&&this.#s.delete(e)}"keyup"===n&&this.#l?.codeSet.has(e)&&this.#h(e)}#u(t){this.#s.add(t),"hold"===this.#i.type?this.#i.codeSet.size===this.#s.size&&(this.#l=this.#i,this.#a=r(0,this.inputs.length,this.#o+1),this.#p()):this.#i.codeSet.size===this.#s.size?this.#p():setTimeout((()=>this.#s.delete(t)),20)}#h(t){clearInterval(this.#c),this.#s=new Set(this.#l.codeSet),this.#s.delete(t),this.#l=null,this.#o=0,this.#a=0}#p(){this.#i.action?.(),"hold"!==this.#i.type?this.#d(this.#i.timeout):null!=this.#i.action&&(this.#c=setInterval(this.#i.action,100)),this.#o>=this.inputs.length-1&&clearTimeout(this.#r),this.#o=r(this.#a,this.inputs.length,this.#o+1),this.#s.clear()}#d(t){clearTimeout(this.#r),this.#r=setTimeout(this.#y.bind(this),t)}#y(){this.onInputBreak&&this.onInputBreak(),this.#o=this.#a}}class ${constructor(t,e="keydown",n=null,i=600){this.codeSet=new Set(t),this.type=e,this.action=n,this.timeout=i}}function R(t,e){let n=!1;const o=e.length;for(let s=0;s<o;s+=1){const l=e[s],c=e[r(0,o,s+1)],u=a(t.x,l.x,c.x,0,1);if(u>0&&u<1){const e=i(l.y,c.y,u);t.y<e&&(n=!n)}}return n}class N{constructor(t,e,n=!0){this.vertexArray=t,this.color=e,this.isColorFill=n}scaled(t){let e=[];for(let n of this.vertexArray){let i=l(n.x*t.x,n.y*t.y);e.push(i)}return new N(e,this.color,this.isColorFill)}}class z{static list=[];transform=void 0;collisionMesh=void 0;v2_velocity=c;n_rotationSpeed=0;v2_acceleration=c;mass=0;bounciness=0;collisionEnabled=!0;constructor(t,e,n,i){this.transform=t,this.collisionPolygon=e,this.collisionEnabled=n,this.physicsEnabled=i,z.list.push(this),m("onNewRigidbody",this)}getWorldSpaceCollisionVertices(){return this.collisionPolygon.scaled(this.transform.v2_scale).vertexArray.map((t=>v(t,this.transform.n_rotation))).map((t=>p(t,this.transform.v2_position)))}getWorldSpaceCollisionPolygon(){return new N(this.getWorldSpaceCollisionVertices(),"white",!1)}checkCollisions(){const t=z.list.filter((t=>t!==this));let e=[];for(const n of t){const t=n.getWorldSpaceCollisionVertices();for(let i of this.getWorldSpaceCollisionVertices())R(i,t)&&e.push({location:i,collider:n})}return e}resolveCollisions(t){for(let e of t)e.location,e.collider,this.v2_velocity.x*=-1,this.v2_velocity.y*=-1}update(){if(this.collisionEnabled){const t=this.checkCollisions();this.physicsEnabled&&this.resolveCollisions(t)}this.v2_velocity=p(this.v2_velocity,this.v2_acceleration),this.transform.v2_localPosition=p(this.transform.v2_position,this.v2_velocity),this.transform.n_localRotation=s(0,360,this.transform.n_rotation+this.n_rotationSpeed)}}class G{static list=[];color=void 0;mesh=void 0;keybindings=void 0;n_accelerationSpeed=.2;n_turningSpeed=.25;n_maxVelocity=10;n_maxAngularVelocity=6;constructor(t,e,n,i,o,s){this.t=new k(l(e,n),0,u),this.rb=new z(this.t,o,!0,!0),this.color=t,this.mesh=i,this.keys=s,this.initialiseInput(),G.list.push(this)}initialiseInput(){let t=`player_${G.list.length}`;V.addBindingGroup(t,!0,[new B([new $([this.keys.left],"hold",this.turn.bind(this,-this.n_turningSpeed))]),new B([new $([this.keys.right],"hold",this.turn.bind(this,this.n_turningSpeed))]),new B([new $([this.keys.up],"hold",this.accelerate.bind(this,this.n_accelerationSpeed))]),new B([new $([this.keys.down],"hold",this.decelerate.bind(this,this.n_accelerationSpeed))]),new B([new $([this.keys.left,this.keys.right],"hold",(()=>this.rb.n_rotationSpeed*=.9))]),new B([new $([this.keys.up,this.keys.down],"hold",(()=>this.rb.v2_velocity=d(this.rb.v2_velocity,.9)))])])}accelerate(t){this.rb.v2_velocity=p(this.rb.v2_velocity,v(l(0,-t),this.t.n_rotation)),f(this.rb.v2_velocity)>this.n_maxVelocity&&(this.rb.v2_velocity=d(y(this.rb.v2_velocity),this.n_maxVelocity))}decelerate(t){this.rb.v2_velocity=p(this.rb.v2_velocity,v(l(0,t),this.t.n_rotation)),f(this.rb.v2_velocity)>this.n_maxVelocity&&(this.rb.v2_velocity=d(y(this.rb.v2_velocity),this.n_maxVelocity))}turn(e){this.rb.n_rotationSpeed=t(-this.n_maxAngularVelocity,this.n_maxAngularVelocity,this.rb.n_rotationSpeed+=e)}}class W{constructor(t){this.polygons=t}scaled(t){let e=[];for(let n of this.polygons)e.push(n.scaled(t));return new W(e)}getVertices(){const t=[];return this.polygons.forEach((e=>{t.push(...e.vertexArray)})),t}}n(89);let q=[{up:"KeyW",left:"KeyA",down:"KeyS",right:"KeyD",action:"KeyE"},{up:"ArrowUp",left:"ArrowLeft",down:"ArrowDown",right:"ArrowRight",action:"ShiftRight"},{up:"KeyI",left:"KeyJ",down:"KeyK",right:"KeyL",action:"Space"},{up:"Numpad8",left:"Numpad4",down:"Numpad5",right:"Numpad6",action:"Numpad0"}],L=[new W([new N([l(-12,12),l(0,-24),l(12,12),l(0,0)],"yellow")]),new W([new N([l(-12,12),l(0,-24),l(12,12),l(0,0)],"red"),new N([l(-12,12),l(0,-5),l(12,12),l(0,0)],"orange")])],O=[new N([l(-12,12),l(0,-24),l(12,12),l(0,0)],"white",!1),new N([l(-12,12),l(0,-24),l(12,12),l(0,0)],"white",!1)];function H(e,n,i,o){return{r:t(0,255,e),g:t(0,255,n),b:t(0,255,i),a:t(0,1,o),toString:()=>`rgba(${e}, ${n}, ${i}, ${o})`}}function j(t){let n=new k(l(50,-42.5),0,u,t.t);n.freeze_rotation=!0;let i=new x(new k(c,0,u,n),new b((()=>`x: ${Math.round(t.t.v2_position.x)}, y: ${Math.round(t.t.v2_position.y)}`)),K.debug),o=new x(new k(l(0,25),0,u,n),new b((()=>`vx: ${e(t.rb.v2_velocity.x,2)}, vy: ${e(t.rb.v2_velocity.y,2)}`)),K.debug),s=new x(new k(l(0,50),0,u,n),new b((()=>`r: ${Math.round(t.t.n_rotation)}`)),K.debug),r=new x(new k(l(0,75),0,u,n),new b((()=>`rs: ${e(t.rb.n_rotationSpeed,2)}`)),K.debug);P(i),P(o),P(s),P(r)}T=document.createElement("canvas"),T.id="renderCanvas",document.querySelector("body").appendChild(T),A=T.getContext("2d"),M=l(T.clientWidth/2,T.clientHeight/2),function(t,e,n){T.style.width=e+"px",T.style.height=n+"px",T.width=e*t,T.height=n*t,A.scale(t,t)}(C,T.clientWidth,T.clientHeight),function(t){let e=M;switch(t=Math.min(t,4)){case 4:new G(H(0,255,0,1),.5*e.x,.5*e.y,L[1],O[1],q[3]);case 3:new G(H(0,0,255,1),1.5*e.x,1.5*e.y,L[0],O[0],q[2]);case 2:new G(H(255,0,0,1),1.5*e.x,.5*e.y,L[1],O[1],q[1]);default:new G(H(255,0,255,1),.5*e.x,1.5*e.y,L[0],O[0],q[0])}}(2),requestAnimationFrame((function t(){m("onTickStart"),function(){let t=l(T.clientWidth,T.clientHeight);for(let e of z.list)e.update(),e.transform.v2_localPosition=l(s(0,t.x,e.transform.v2_position.x),s(0,t.y,e.transform.v2_position.y))}(),function(){let t=E.filter((function(t){return t.layer.isVisible&&t.isVisible}));t.sort((function(t,e){return t.layer.renderOrder>e.layer.renderOrder})),A.clearRect(0,0,T.clientWidth,T.clientHeight);for(let e of t)e.draw(A,C)}(),requestAnimationFrame(t),m("onTickEnd")})),window.addEventListener("keydown",(function(t){t.repeat||V.handleKeyDown(t)})),window.addEventListener("keyup",(function(t){V.handleKeyUp(t)})),P(new I(G.list[0].t,G.list[0].mesh,K.game)),P(new I(G.list[1].t,G.list[1].mesh,K.game)),j(G.list[0]),j(G.list[1]),V.addBindingGroup("cheats",!0,[new B([new $(["Backquote"]),new $(["Enter"],"keydown",(()=>K.debug.isVisible=!K.debug.isVisible))])])})()})();